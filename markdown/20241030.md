## 内存报错

在这里报错

```cpp
namespace Meow
{
    struct SurfaceData
    {
        vk::Extent2D         extent;
        vk::raii::SurfaceKHR surface = nullptr;

        SurfaceData(vk::raii::Instance const& instance, GLFWwindow* glfw_window, vk::Extent2D const& extent_)
            : extent(extent_)
        {
            VkSurfaceKHR _surface;
            VkResult err = glfwCreateWindowSurface(static_cast<VkInstance>(*instance), glfw_window, nullptr, &_surface);
            if (err != VK_SUCCESS)
                throw std::runtime_error("Failed to create window!");
            surface = vk::raii::SurfaceKHR(instance, _surface);
        }

        SurfaceData(std::nullptr_t) {}
    };
} // namespace Meow
```

```
Unhandled exception at 0x00007FF8C916F39C in MeowEditor.exe: Microsoft C++ exception: std::runtime_error at memory location 0x00000010034FE948.
```

这里 `glfwCreateWindowSurface` 返回 `VK_ERROR_INITIALIZATION_FAILED(-3)`，`_surface` 是 null

就很神奇

这里之前从来没有过问题

难道是因为这里没有 dllexport？

## glfwCreateWindowSurface VK_ERROR_INITIALIZATION_FAILED 

`glfwCreateWindowSurface` 这个函数说了，如果是报错 `VK_ERROR_INITIALIZATION_FAILED` 的话，可能是 vulkan loader 没加载

感觉像是 glfwinit 没调用

于是加了 glfwinit 就没这个问题了

## getVkHeaderVersion 报错

然后就是 `m_dispatcher->getVkHeaderVersion()` 的报错

感觉这个是 vulkan 加载的问题

于是把相关的定义放在 public

```cmake    
target_compile_definitions(${RUNTIME_NAME} PRIVATE
  LIBRARY_EXPORTS
)
target_compile_definitions(${RUNTIME_NAME} PUBLIC
  ENGINE_ROOT_DIR="${ENGINE_ROOT_DIR}"
  $<$<CONFIG:Debug>:MEOW_DEBUG>
  $<$<CONFIG:Release>:MEOW_RELEASE>
  $<$<CONFIG:Debug>:VKB_DEBUG>
  $<$<CONFIG:Debug>:VKB_VALIDATION_LAYERS>
  VK_USE_PLATFORM_WIN32_KHR # TODO: Config vulkan platform preprocesser
                            # according to cmake build platform
  VULKAN_HPP_STORAGE_SHARED # compile dll when using vulkan hpp
  VULKAN_HPP_STORAGE_SHARED_EXPORT # export DispatchLoaderDynamic from
                                  # vulkan hpp
  GLM_ENABLE_EXPERIMENTAL # for GLM: GLM_GTX_component_wise
  IMGUI_DEFINE_MATH_OPERATORS
  # _DISABLE_STRING_ANNOTATION # for ASAN
  # _DISABLE_VECTOR_ANNOTATION # for ASAN
  NOMINMAX # for std::numeric_limits<double>::min() and max()
)
```

就没有这个问题了

## ImGui_ImplVulkan_NewFrame 报错

```cpp
void ImGui_ImplVulkan_NewFrame()
{
    ImGui_ImplVulkan_Data* bd = ImGui_ImplVulkan_GetBackendData();
    IM_ASSERT(bd != nullptr && "Did you call ImGui_ImplVulkan_Init()?");

    if (!bd->FontDescriptorSet)
        ImGui_ImplVulkan_CreateFontsTexture();
}
```

直接在这里报错

看上去我就是没有 `ImGui_ImplVulkan_Init`